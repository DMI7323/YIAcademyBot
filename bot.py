import telebot

# –í—Å—Ç–∞–≤ —Å–≤—ñ–π —Ç–æ–∫–µ–Ω —Å—é–¥–∏ (–ù–ï –ø—É–±–ª—ñ–∫—É–π —É –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –º—ñ—Å—Ü—è—Ö!)
BOT_TOKEN = "8071401341:AAFP8TVUplsB9cDzat6kx93JUP-QdFeoREc"

bot = telebot.TeleBot(BOT_TOKEN)

# –°–ª–æ–≤–Ω–∏–∫ –≤–∞–ª—ñ–¥–Ω–∏—Ö –∫–æ–¥—ñ–≤ –¥–æ—Å—Ç—É–ø—É ‚Äî –∑–∞–º—ñ–Ω–∏ –Ω–∞ —Å–≤–æ—ó —Ä–µ–∞–ª—å–Ω—ñ –∫–æ–¥–∏ —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
valid_codes = {
    "ABC123": {
        "video_link": "https://t.me/+channel_video_link",
        "chat_link": "https://t.me/+chat_link"
    },
    "XYZ789": {
        "video_link": "https://t.me/+another_channel_link",
        "chat_link": "https://t.me/+another_chat_link"
    }
}

# –ó–∞–ø–∞–º'—è—Ç–æ–≤—É—î–º–æ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —â–æ–± –Ω–µ –¥–∞–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –ø–æ–≤—Ç–æ—Ä–Ω–æ
used_users = {}

@bot.message_handler(commands=["start"])
def send_welcome(message):
    welcome_text = (
        "üëã –í—ñ—Ç–∞—î–º–æ –≤ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–º—É –±–æ—Ç—ñ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ –∑–∞–∫—Ä–∏—Ç–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤ —ñ —á–∞—Ç—ñ–≤ —à–∫–æ–ª–∏ –Æ–ª—ñ—ó –Ü—â—É–∫!\n\n"
        "‚ö†Ô∏è –£–≤–∞–≥–∞! –í—Å—ñ –∫—É—Ä—Å–∏, –≤—ñ–¥–µ–æ—É—Ä–æ–∫–∏ —Ç–∞ —á–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ –∑–∞ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–º–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º–∏ –ø—ñ—Å–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤ —Ü—å–æ–º—É –±–æ—Ç—ñ.\n\n"
        "üîê –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:\n"
        "1Ô∏è‚É£ –í–≤–µ–¥—ñ—Ç—å —Å–≤—ñ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø—É, —è–∫–∏–π –æ—Ç—Ä–∏–º–∞–ª–∏ –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –∫—É—Ä—Å—É.\n"
        "2Ô∏è‚É£ –ë–æ—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å –π–æ–≥–æ —Å–ø—Ä–∞–≤–∂–Ω—ñ—Å—Ç—å —Ç–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.\n"
        "3Ô∏è‚É£ –Ø–∫—â–æ –≤—Å–µ –≥–∞—Ä–∞–∑–¥ ‚Äî –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∞–∫—Ç–∏–≤–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–∞–∫—Ä–∏—Ç–∏–π –∫–∞–Ω–∞–ª —ñ —á–∞—Ç –≤–∞—à–æ–≥–æ –∫—É—Ä—Å—É.\n"
        "4Ô∏è‚É£ –Ø–∫—â–æ –∫–æ–¥ –Ω–µ–¥—ñ–π—Å–Ω–∏–π –∞–±–æ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π ‚Äî –±–æ—Ç –ø–æ–≤—ñ–¥–æ–º–∏—Ç—å –ø—Ä–æ —Ü–µ.\n\n"
        "üìå –í–∞–∂–ª–∏–≤–æ!\n"
        "–£—Å—ñ –∫–æ–¥–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ —Ç–∞ –¥—ñ—é—Ç—å –ª–∏—à–µ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø—É —Ç—Ä–µ—Ç—ñ–º –æ—Å–æ–±–∞–º –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∞.\n\n"
        "–ë–µ–∑ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞–∫—Ä–∏—Ç–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –Ω–µ–º–æ–∂–ª–∏–≤–∏–π.\n\n"
        "–ù–∞–ø–∏—à—ñ—Ç—å /code, —â–æ–± –≤–≤–µ—Å—Ç–∏ —Å–≤—ñ–π –∫–æ–¥."
    )
    bot.reply_to(message, welcome_text)

@bot.message_handler(commands=["code"])
def ask_code(message):
    msg = bot.send_message(message.chat.id, "üîê –í–≤–µ–¥–∏ —Å–≤—ñ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø—É:")
    bot.register_next_step_handler(msg, check_code)

def check_code(message):
    user_id = message.chat.id
    code = message.text.strip().upper()

    if user_id in used_users:
        bot.send_message(user_id, "‚úÖ –¢–∏ –≤–∂–µ –∞–∫—Ç–∏–≤—É–≤–∞–≤ –¥–æ—Å—Ç—É–ø.\n"
                                  f"üì• –í—ñ–¥–µ–æ—É—Ä–æ–∫–∏: {used_users[user_id]['video']}\n"
                                  f"üí¨ –ß–∞—Ç: {used_users[user_id]['chat']}")
        return

    if code in valid_codes:
        links = valid_codes[code]
        used_users[user_id] = {
            "code": code,
            "video": links["video_link"],
            "chat": links["chat_link"]
        }
        bot.send_message(user_id, "‚úÖ –ß—É–¥–æ–≤–æ! –û—Å—å —Ç–≤–æ—ó –ø–æ—Å–∏–ª–∞–Ω–Ω—è:\n"
                                  f"üì• –í—ñ–¥–µ–æ—É—Ä–æ–∫–∏: {links['video_link']}\n"
                                  f"üí¨ –ß–∞—Ç: {links['chat_link']}")
    else:
        bot.send_message(user_id, "‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑ –∞–±–æ –∑–≤–µ—Ä–Ω–∏—Å—è –¥–æ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.")

bot.polling()
